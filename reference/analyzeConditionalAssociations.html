<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stepwise conditional association analysis — analyzeConditionalAssociations • midasHLA</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Stepwise conditional association analysis — analyzeConditionalAssociations" />
<meta property="og:description" content="analyzeConditionalAssociations perform stepwise conditional testing
adding the previous top-associated variable as covariate, until there are no
more significant variables based on a self-defined threshold." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">midasHLA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.19</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MiDAS_tutorial.html">MiDAS tutorial</a>
    </li>
    <li>
      <a href="../articles/MiDAS_vignette.html">MiDAS quick start</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stepwise conditional association analysis</h1>
    
    <div class="hidden name"><code>analyzeConditionalAssociations.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>analyzeConditionalAssociations</code> perform stepwise conditional testing
adding the previous top-associated variable as covariate, until there are no
more significant variables based on a self-defined threshold.</p>
    </div>

    <pre class="usage"><span class='fu'>analyzeConditionalAssociations</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>variables</span>,
  placeholder <span class='op'>=</span> <span class='st'>"term"</span>,
  correction <span class='op'>=</span> <span class='st'>"bonferroni"</span>,
  n_correction <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>th</span>,
  th_adj <span class='op'>=</span> <span class='cn'>TRUE</span>,
  keep <span class='op'>=</span> <span class='cn'>FALSE</span>,
  rss_th <span class='op'>=</span> <span class='fl'>1e-07</span>,
  exponentiate <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An existing fit from a model function such as lm, glm and many
others.</p></td>
    </tr>
    <tr>
      <th>variables</th>
      <td><p>Character vector specifying variables to use in association
tests.</p></td>
    </tr>
    <tr>
      <th>placeholder</th>
      <td><p>String specifying term to substitute with value from
<code>x</code>. Ignored if set to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>correction</th>
      <td><p>String specifying multiple testing correction method. See
details for further information.</p></td>
    </tr>
    <tr>
      <th>n_correction</th>
      <td><p>Integer specifying number of comparisons to consider
during multiple testing correction calculations. For Bonferroni correction
it is possible to specify a number lower than the number of comparisons
being made. This is useful in cases when knowledge about the biology or
redundance of alleles reduces the need for correction. For other methods it
must be at least equal to the number of comparisons being made; only set
this (to non-default) when you know what you are doing!</p></td>
    </tr>
    <tr>
      <th>th</th>
      <td><p>Number specifying threshold for a variable to be considered
significant.</p></td>
    </tr>
    <tr>
      <th>th_adj</th>
      <td><p>Logical flag indicating if adjusted p-value should be used as
threshold criteria, otherwise unadjusted p-value is used.</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>Logical flag indicating if the output should be a list of results
resulting from each selection step. Default is to return only the final
result.</p></td>
    </tr>
    <tr>
      <th>rss_th</th>
      <td><p>Number specifying residual sum of squares threshold at which
function should stop adding additional variables. As the residual sum of
squares approaches <code>0</code> the perfect fit is obtained making further
attempts at variable selection nonsense. This behavior can be controlled
using <code>rss_th</code>.</p></td>
    </tr>
    <tr>
      <th>exponentiate</th>
      <td><p>Logical flag indicating whether or not to exponentiate
the coefficient estimates. Internally this is passed to
<code><a href='https://generics.r-lib.org/reference/tidy.html'>tidy</a></code>. This is typical for logistic and multinomial
regressions, but a bad idea if there is no log or logit link. Defaults to
FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Tibble with stepwise conditional testing results or a list of tibbles,
 see <code>keep</code> argument. The first column <code>"term"</code> hold the names of 
 <code>variables</code>. Further columns depends on the used model and are 
 determined by associated <code>tidy</code> function. Generally they will include 
 <code>"estimate"</code>, <code>"std.error"</code>, <code>"statistic"</code>, <code>"p.value"</code>, 
 <code>"conf.low"</code>, <code>"conf.high"</code>, <code>"p.adjusted"</code>.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>midas</span> <span class='op'>&lt;-</span> <span class='fu'><a href='prepareMiDAS.html'>prepareMiDAS</a></span><span class='op'>(</span>hla_calls <span class='op'>=</span> <span class='va'>MiDAS_tut_HLA</span>,
                      colData <span class='op'>=</span> <span class='va'>MiDAS_tut_pheno</span>,
                      experiment <span class='op'>=</span> <span class='st'>"hla_alleles"</span><span class='op'>)</span>

<span class='co'># analyzeConditionalAssociations expects model data to be a data.frame</span>
<span class='va'>midas_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='va'>midas</span><span class='op'>)</span>

<span class='co'># define base model</span>
<span class='va'>object</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>disease</span> <span class='op'>~</span> <span class='va'>term</span>, data <span class='op'>=</span> <span class='va'>midas_data</span><span class='op'>)</span>
<span class='fu'>analyzeConditionalAssociations</span><span class='op'>(</span><span class='va'>object</span>,
                            variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"B*14:02"</span>, <span class='st'>"DRB1*11:01"</span><span class='op'>)</span>,
                            th <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: No significant variables found. Returning empty table.</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 0 x 9</span><span>
#&gt; </span><span style='color: #555555;'># … with 9 variables: term </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, estimate </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, std.error </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,</span><span>
#&gt; </span><span style='color: #555555;'>#   statistic </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, p.value </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, conf.low </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, conf.high </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,</span><span>
#&gt; </span><span style='color: #555555;'>#   p.adjusted </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, covariates </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span></div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christian Hammer, Maciej Migdał.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


